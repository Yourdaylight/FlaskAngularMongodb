<form
  nz-form
  nzLayout="inline"
  [formGroup]="searchForm"
  (ngSubmit)="getMovieList()"
>
  <div nz-row>
    <div
      nz-col
      nzSpan="8"
      *ngFor="let field of searchField"
      style="margin-top: 20px"
    >
      <nz-form-item>
        <nz-form-label>{{ field.label }}</nz-form-label>
        <nz-form-control [nzErrorTip]="'Please input ' + field.label!">
          <nz-select
            *ngIf="field.value == 'type'"
            [ngModel]="field.value"
            [nzPlaceHolder]="field.label"
          >
            <nz-option
              *ngFor="let item of typeOption"
              [nzValue]="item.value"
              [nzLabel]="item.label"
            ></nz-option>
          </nz-select>
          <input
            *ngIf="field.value != 'type'"
            nz-input
            [formControlName]="field.value"
            [placeholder]="field.label"
          />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col nzSpan="8" style="margin-top: 20px">
      <button nz-button nzType="primary">Submit</button>
      <button
        nz-button
        nzType="default"
        (click)="isVisible = true"
        style="margin-left: 15px"
      >
        <i nz-icon nzType="plus" nzTheme="outline"></i>Add Movie
      </button>
    </div>
  </div>
</form>

<div style="padding: 5px 30px">
  <nz-spin [nzSpinning]="loading">
    <div nz-row [nzGutter]="30">
      <div
        nz-col
        [nzSpan]="4"
        *ngFor="let data of movieList"
        class="card-shadow"
        style="margin-bottom: 20px; position: relative"
      >
        <img
          style="
            width: 100%;
            height: 150px;
            cursor: pointer;
            border-radius: 8px;
          "
          [src]="data.pic_url"
          (click)="toDetail(data)"
        />
        <span
          style="position: absolute; right: 24px; top: 120px; color: #eee"
          >{{ data.duration }}</span
        >
        <div
          style="
            font-weight: bold;
            font-size: 16px;
            margin: 2px 0;
            overflow: hidden;
            height: 25px;
            white-space: nowrap;
            text-overflow: ellipsis;
          "
        >
          {{ data.title }}
        </div>
        <div
          style="
            overflow: hidden;
            height: 25px;
            white-space: nowrap;
            text-overflow: ellipsis;
          "
        >
          {{ data.description }}
        </div>
      </div>
    </div>
  </nz-spin>
  <nz-pagination
    [nzPageIndex]="page"
    [nzTotal]="total"
    nzShowSizeChanger
    [nzPageSize]="size"
    (nzPageIndexChange)="pageChange($event)"
    (nzPageSizeChange)="pageSizeChange($event)"
    style="text-align: right"
  ></nz-pagination>
</div>

<nz-modal
  [(nzVisible)]="isVisible"
  nzTitle="Add Movie"
  nzOkText="Ok"
  nzCancelText="Cancel"
  (nzOnOk)="submitForm()"
  (nzOnCancel)="isVisible = false"
>
  <ng-container *nzModalContent>
    <form nz-form [formGroup]="addForm">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="24" *ngFor="let field of addField">
          <nz-form-item>
            <nz-form-label [nzSm]="6" [nzXs]="24" nzRequired nzFor="name"
              >{{ field.label }}
            </nz-form-label>
            <nz-form-control
              [nzSm]="14"
              [nzXs]="24"
              [nzErrorTip]="'Please input ' + field.label!"
            >
              <input
                nz-input
                [formControlName]="field.value"
                id="name"
                [placeholder]="field.label"
              />
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </form>
  </ng-container>
</nz-modal>
